<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Student Dashboard</title>
<style>
body { font-family: sans-serif; margin:0; background:#0b0b0b; color:#eee; }
header { padding:20px; text-align:center; background:#111; border-bottom:1px solid #333; }
header h1 { margin:0; font-size:2em; color:#4caf50; }
.dashboard { display:flex; justify-content:center; gap:20px; padding:10px; flex-wrap:wrap; }
.card { background:#222; padding:15px 20px; border-radius:8px; min-width:120px; text-align:center; box-shadow:0 0 10px #000; }
.card h2 { margin:0; font-size:1.5em; color:#4caf50; }
.card p { margin:5px 0 0; color:#ccc; }
.controls { max-width:600px; margin:20px auto; display:flex; gap:10px; flex-wrap:wrap; }
.controls input, .controls select { flex:1; padding:10px; background:#222; border:none; color:#eee; border-radius:5px; }
#results, #dbList { max-width:600px; margin:10px auto; }
.row { padding:10px; border-bottom:1px solid #333; cursor:pointer; display:flex; justify-content:space-between; background:#111; border-radius:5px; margin-bottom:5px; }
.row:hover { background:#222; }
#overlay { position:fixed; top:0; left:0; width:100%; height:100%; background:#000c; display:none; }
#overlay.active { display:block; }
#drawer { position:fixed; right:0; top:0; width:350px; height:100%; background:#111; padding:20px; display:none; overflow:auto; box-shadow:-5px 0 20px #000; }
#drawer.active { display:block; }
#d_photo { width:100%; display:block; margin-bottom:10px; border-radius:5px; }
button { background:#444; border:none; padding:5px 10px; color:#eee; cursor:pointer; border-radius:5px; margin-top:10px; }
</style>
</head>
<body>

<header>
  <h1>Student Dashboard</h1>
  <div class="dashboard">
    <div class="card"><h2 id="total">0</h2><p>Total Students</p></div>
    <div class="card"><h2 id="grade7">0</h2><p>Grade 7</p></div>
    <div class="card"><h2 id="grade8">0</h2><p>Grade 8</p></div>
  </div>
</header>

<div class="controls">
  <input id="query" placeholder="Search by name...">
  <select id="gradeFilter">
    <option value="all">All Grades</option>
    <option value="7">Grade 7</option>
    <option value="8">Grade 8</option>
  </select>
</div>

<div id="results"></div>
<div id="dbList"></div>

<div id="overlay"></div>

<div id="drawer">
  <img id="d_photo">
  <p>Name: <span id="d_name"></span></p>
  <p>ID: <span id="d_id"></span></p>
  <p>Status: <span id="d_status"></span></p>
  <p>Grade: <span id="d_grade"></span></p>
  <p>Guardian: <span id="d_guardian"></span></p>
  <p>Address: <span id="d_address"></span></p>
  <p>School: <span id="d_school"></span></p>
  <p>Notes: <span id="d_notes"></span></p>
  <p>Email: <span id="d_email"></span></p>
  <p>Password: <span id="d_pass"></span></p>
  <button id="close">Close</button>
</div>

<script>
const students = [
  { name:'Thomas J. Graham', id:'56254', grade:'8', guardian:'Gerald Graham / Denise Schellenger', address:'27 Erial Rd Blackwood, NJ 08012', school:'CWL', notes:'no additional flags', status:'active', hasPhoto:true },
  { name:'Lucas Johnson', id:'54698', grade:'8', guardian:'Bryan Johnson / Lisa Johnson', address:'108 West Ct Blackwood, NJ 08012', school:'CWL', notes:'no additional flags', status:'active', hasPhoto:true },
  { name:'Ezra J. Cook', id:'56431', grade:'8', guardian:'LaShaya Ford', address:'502 Harbor Ln Sicklerville, NJ 08081', school:'CWL', notes:'Football Team', status:'active', hasPhoto:false },
  { name:'Kinsley Alex Boguszewski', id:'56847', grade:'7', guardian:'Daniel & Dana Boguszewski', address:'1081 Kearsley Rd Sicklerville, NJ 08081', school:'Ann Mullen', notes:'', status:'active', hasPhoto:false },
  { name:'Giuliana G McDade', id:'56903', grade:'8', guardian:'Jermain & Melissa McDade', address:'3 Mulberry St Sicklerville, NJ 08081', school:'Ann Mullen', notes:'', status:'active', hasPhoto:false },
  { name:'Dominic Tarantino', id:'56121', grade:'8', guardian:'Francis & Deborah Tarantino', address:'319 Dearborne Ave Blackwood, NJ 08012', school:'CWL', notes:'', status:'active', hasPhoto:false },
  { name:'Chase Towers', id:'56365', grade:'8', guardian:'Gary Towers & Kathleen Macaro', address:'32 Annapolis Dr Sicklerville, NJ 08081', school:'Ann Mullen', notes:'', status:'active', hasPhoto:false },
  { name:'Evelyn Zechman', id:'56366', grade:'8', guardian:'Michael & Janae Zechman', address:'1 Blue Spruce Dr Sicklerville, NJ 08081', school:'Ann Mullen', notes:'', status:'active', hasPhoto:false },
  { name:'Alyssa McDonel', id:'56641', grade:'7', guardian:'Robert & Bernadette McDonel', address:'29 Brewer Ave Apt 1 Blackwood, NJ 08012', school:'Glenn Landing', notes:'', status:'active', hasPhoto:false }
];

const q = document.getElementById('query');
const results = document.getElementById('results');
const dbList = document.getElementById('dbList');
const overlay = document.getElementById('overlay');
const drawer = document.getElementById('drawer');
const photoEl = document.getElementById('d_photo');
const gradeFilter = document.getElementById('gradeFilter');

function mask(s){
  if(s.hasPhoto) return s;
  return {...s, id:'*******', guardian:'*******', address:'*******', notes:'*******', status:'*******', email:'*******', password:'*******'};
}

function emailFor(name){
  return `${name.toLowerCase().split(' ').slice(-1)[0]}.${name.toLowerCase().split(' ')[0]}@gloucestertownshipschools.org`;
}

function openDrawer(s){
  const student = mask(s);
  document.getElementById('d_name').textContent = student.name;
  document.getElementById('d_id').textContent = student.id;
  document.getElementById('d_status').textContent = student.status;
  document.getElementById('d_grade').textContent = student.grade; // keep grade visible
  document.getElementById('d_guardian').textContent = student.guardian;
  document.getElementById('d_address').textContent = student.address;
  document.getElementById('d_school').textContent = student.school; // keep school visible
  document.getElementById('d_notes').textContent = student.notes;
  document.getElementById('d_email').textContent = student.hasPhoto ? emailFor(student.name) : '*******';
  document.getElementById('d_pass').textContent = student.hasPhoto ? `Password: GTps${student.id}` : '*******';

  if(student.hasPhoto){
    photoEl.src = `${student.id}.jpg`;
    photoEl.onerror = () => { photoEl.src = ''; };
    photoEl.style.display = 'block';
  } else {
    photoEl.style.display = 'none';
  }

  overlay.classList.add('active');
  drawer.classList.add('active');
}

function closeDrawer(){
  overlay.classList.remove('active');
  drawer.classList.remove('active');
}

function makeRow(s){
  const student = mask(s);
  const row = document.createElement('div');
  row.className = 'row';
  row.innerHTML = `<span>${student.name}</span><span class="tag">${student.hasPhoto ? student.id : '*******'}</span>`;
  row.onclick = () => openDrawer(s);
  return row;
}

function renderDB(){
  dbList.innerHTML = '';
  let list = students;
  if(gradeFilter.value !== 'all') list = list.filter(s => s.grade === gradeFilter.value);
  list.forEach(s => dbList.appendChild(makeRow(s)));
  renderStats(list);
}

function renderSearch(){
  const v = (q.value || '').toLowerCase().trim();
  results.innerHTML = '';
  let list = students;
  if(gradeFilter.value !== 'all') list = list.filter(s => s.grade === gradeFilter.value);
  if(!v) return;
  const hits = list.filter(s => s.name.toLowerCase().includes(v));
  if(!hits.length){
    results.innerHTML = '<div class="row"><span>no match</span></div>';
    return;
  }
  hits.forEach(s => results.appendChild(makeRow(s)));
}

function renderStats(list){
  document.getElementById('total').textContent = students.length;
  document.getElementById('grade7').textContent = students.filter(s=>s.grade==='7').length;
  document.getElementById('grade8').textContent = students.filter(s=>s.grade==='8').length;
}

q.addEventListener('input', renderSearch);
gradeFilter.addEventListener('change', renderDB);
renderDB();

overlay.onclick = closeDrawer;
document.getElementById('close').onclick = closeDrawer;
</script>

</body>
</html>
